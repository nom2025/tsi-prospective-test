# 地震データ特徴探索ガイド

## 概要

`ソース/explore_features.py` スクリプトは、生データから既存のスコア計算で使用されていない新しい特徴やパターンを探索します。

## 実行方法

ターミナルまたはコマンドプロンプトで以下のコマンドを実行してください：

```bash
python ソース/explore_features.py
```

または、プロジェクトルートディレクトリから：

```bash
cd "c:\Users\arumo\OneDrive\デスクトップ\学習_AI\40_AI駆動開発\52-2_cursor_地震"
python ソース\explore_features.py
```

## 探索される特徴

### 1. 地域別パターン分析
- **目的**: 地域ごとの発生頻度、マグニチュード分布、地域間の相関を分析
- **出力ファイル**:
  - `regional_statistics.csv`: 地域ごとの統計情報（発生回数、平均M、標準偏差など）
  - `regional_correlations.csv`: 強い相関を持つ地域ペア（相関係数 > 0.3）

### 2. マグニチュードトレンド分析
- **目的**: マグニチュードの時系列トレンドとM7発生前のパターンを分析
- **特徴量**:
  - 7日・30日移動平均
  - 変化率（前日比）
  - M7発生前30日の特徴
- **出力ファイル**:
  - `magnitude_trends.csv`: 日毎のマグニチュード統計とトレンド
  - `pre_m7_patterns.csv`: M7以上地震発生前30日の特徴

### 3. 地震発生間隔分析
- **目的**: 地震発生間隔の分布と連続発生パターンを分析
- **特徴量**:
  - 平均間隔、中央値間隔、標準偏差
  - 3日以上連続発生した期間
- **出力ファイル**:
  - `consecutive_periods.csv`: 連続発生期間の記録

### 4. 世界地震と国内地震の相関分析
- **目的**: 世界地震発生後の国内地震への影響を分析
- **特徴量**:
  - 時間差相関（1-7日後）
  - 世界M7発生後7日間の国内地震パターン
- **出力ファイル**:
  - `world_japan_correlation.csv`: 日毎の世界・国内地震統計
  - `post_world_m7_patterns.csv`: 世界M7発生後の国内地震特徴

### 5. 深さとマグニチュードの関係分析
- **目的**: 深さデータと国内地震のマグニチュードの相関を分析
- **特徴量**:
  - 深さとマグニチュードの相関係数
  - 深さカテゴリ別の統計（浅い/中/深い/非常に深い）
- **出力ファイル**:
  - `depth_magnitude_relationship.csv`: 深さと国内地震の関係データ
  - `depth_category_statistics.csv`: 深さカテゴリ別統計

### 6. 季節性パターン分析
- **目的**: 月別・季節別の発生パターンを分析
- **特徴量**:
  - 月別の発生回数、平均M、最大M
  - 季節別の統計
- **出力ファイル**:
  - `monthly_statistics.csv`: 月別統計
  - `seasonal_statistics.csv`: 季節別統計

### 7. マグニチュード分布の特徴量分析
- **目的**: 分布の形状を表す統計量を計算
- **特徴量**:
  - 歪度（分布の非対称性）
  - 尖度（分布の尖り具合）
  - 分位数（25%、75%）
  - M7発生前の分布特徴
- **出力ファイル**:
  - `magnitude_distribution_features.csv`: 日毎の分布特徴量
  - `pre_m7_distribution_features.csv`: M7発生前の分布特徴

## 出力先

全ての分析結果は `データ分析結果出力/特徴探索結果/` フォルダに保存されます。

サマリーレポートは `データ分析結果出力/特徴探索結果/feature_exploration_report.md` に自動生成されます。

## 既存の分析との違い

既存の `calculate_scores.py` では以下の特徴が使用されています：
- 日毎の発生回数
- マグニチュードの閾値（M5、M7など）
- 特定地域での発生
- 連続性パターン
- 過去30日間の累積統計

この特徴探索スクリプトでは、以下の**新しい特徴**を発見します：
- 地域間の相関関係
- マグニチュードのトレンド（移動平均、変化率）
- 地震発生間隔のパターン
- 世界地震と国内地震の時間差相関
- 深さとマグニチュードの関係
- 季節性パターン
- 分布の形状特徴（歪度、尖度）

## 次のステップ

1. **スコア計算への組み込み**: 発見した特徴を `calculate_scores.py` のスコア計算に組み込む
2. **機械学習モデル**: これらの特徴を機械学習モデルの特徴量として活用
3. **可視化**: 発見したパターンをグラフで可視化して確認

## 注意事項

- スクリプトの実行には数分かかる場合があります（データ量によります）
- 一部の分析では `scipy` ライブラリが必要です（既に `requirements.txt` に含まれています）
- 日本語フォントが正しく設定されていない場合、グラフの日本語表示に問題が生じる可能性があります
